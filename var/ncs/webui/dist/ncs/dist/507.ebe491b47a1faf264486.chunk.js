"use strict";(self.webpackChunkwebui=self.webpackChunkwebui||[]).push([[507],{86507:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._getServiceList=t._resultToInstanceCount=t._requestServiceCounts=t._countServices=t._getServicePointsSchemas=t._parseDeploymentTriggers=t.runServiceActionThunk=t.getServiceInstanceCount=t.getServiceDeployments=t.getServices=t.getServicePointsAndSchemas=t.getServicePoints=t.setSearchAction=t.setServiceExpandedAction=t.getServicePointSchemasCompleteAction=t.getServicePointsAction=t.getServiceInstanceCountErrorAction=t.getServiceInstanceCountAction=t.getServiceInstanceCountStartAction=t.getServiceDeploymentsErrorAction=t.getServiceDeploymentsStartAction=t.getServiceDeploymentsAction=t.selectServiceAction=t.getServicesErrorAction=t.getServicesCompleteAction=t.getServicesStartAction=void 0;var c=E(n(39562)),r=E(n(34860)),s=E(n(2752)),o=n(99531),i=n(74198),a=n(94030),l=n(46560),u=n(14172),d=n(71447),S=n(6617),v=n(49562),p=n(17223),y=n(92252),h=n(23143),m=n(28153),g=n(47810);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function E(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var c={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(c,s,o):c[s]=e[s]}return c.default=e,n&&n.set(e,c),c}const C=()=>({type:r.SERVICES_GET_START});t.getServicesStartAction=C;const _=()=>({type:r.SERVICES_GET_COMPLETE});t.getServicesCompleteAction=_;const A=e=>({type:r.SERVICES_GET_ERROR,error:e});t.getServicesErrorAction=A,t.selectServiceAction=(e,t)=>({type:r.SERVICES_SELECT,names:t,isSelected:e});const O=e=>({type:r.SERVICE_DEPLOYMENTS_GET,deployments:e});t.getServiceDeploymentsAction=O;const P=()=>({type:r.SERVICE_DEPLOYMENTS_GET_START});t.getServiceDeploymentsStartAction=P;const I=()=>({type:r.SERVICE_DEPLOYMENTS_GET_ERROR});t.getServiceDeploymentsErrorAction=I;const T=()=>({type:r.SERVICE_INSTANCE_COUNT_GET_START});t.getServiceInstanceCountStartAction=T;const b=e=>({type:r.SERVICE_INSTANCE_COUNT_GET,count:e});t.getServiceInstanceCountAction=b;const R=e=>({type:r.SERVICE_INSTANCE_COUNT_GET_ERROR,error:e});t.getServiceInstanceCountErrorAction=R;const k=e=>({type:r.SERVICE_POINTS_GET,...e});t.getServicePointsAction=k,t.getServicePointSchemasCompleteAction=(e,t)=>({type:r.GET_SERVICE_POINT_SCHEMAS_COMPLETE,schemas2:e,types:t}),t.setServiceExpandedAction=(e,t,n)=>({type:r.SET_EXPANDED_ROW,path:e,column:t,isExpanded:n}),t.setSearchAction=e=>({type:r.SET_SEARCH,value:e});const N=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.funcs,n=void 0===t?{}:t,c=n.jsonrpc,r=void 0===c?s.default:c;return r("get_service_points",{}).then((e=>e.service_points),(()=>({})))};t.getServicePoints=N;const w=e=>({keys:c.getKeys(e),schema:e,name:c.name(e),path:c.keypath(e),base:c.keypath(e)}),j=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.funcs,c=void 0===n?{}:n,r=c.getSchemas,o=void 0===r?s.getSchemas:r,i=c.readThunk,a=void 0===i?d.read:i;return async t=>{const n=(0,l.isObject)(e)?Object.keys(e):[];if(0===n.length)return[];const c=(await t(a())).th;return(await o({th:c,paths:n})).reduce(((e,t)=>(t&&t.result&&e.push(w(t.result)),e)),[])}};t._getServicePointsSchemas=j;const D=function(e,t,n,c,r){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},i=s.funcs,a=void 0===i?{}:i,l=a.query,d=void 0===l?u.query:l;return(s,i)=>{const a=(0,h.selectServiceSearch)(i()),l=e.keys,u=a&&(0,o.isNonEmptyArray)(l)?`[${e.keys.map((e=>`contains(${e}, "${a}")`)).join(" or ")}]`:"",S=`${e.base}${u}`;return s(d({selection:[...e.keys,"count(modified/devices)","plan-location","modified"],path:e.base,sort:c,sortOrder:r,initialOffset:t,chunkSize:n,result_as:"keypath-value",xpathExpr:S,contextNode:void 0}))}};t._getServiceList=D;const L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.funcs,n=void 0===t?{}:t,r=n.getServicePointsFunc,s=void 0===r?N:r,o=n.getServicePointsSchemasFunc,i=void 0===o?j:o;return async e=>{const t=await s(),n=(await e(i(t))).filter((e=>!c.isAccessDenied(e.schema))),r=n.reduce(((e,t)=>({...e,[t.path]:(0,l.omitKeys)(t,["schema"])})),{});return e(k({service_points:r})),n}};t.getServicePointsAndSchemas=L,t.getServices=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.servicePoint,n=e.offset,c=e.chunkSize,r=e.sortColumn,s=e.sortOrder,o=e.funcs,i=void 0===o?{}:o,l=i.getServiceListFunc,u=void 0===l?D:l,d=i.getGlobalApplicationSettingFunc,S=void 0===d?g.getGlobalApplicationSetting:d,h=i.getSchemaFunc,m=void 0===h?v.getSchema:h;return async(e,o)=>{e(C());try{if((0,a.isNonEmptyString)(t)){await e(S({setting:g.ACTION_STATUS_INDICATOR_TIMEOUT}));const i=(0,y.selectIsLoaded)(o(),{path:t})?{schema:(0,p.selectSchema)(o(),t)}:await e(m({path:t}));await e(u(w(i.schema),n,c,r,s))}e(_())}catch(t){e(A(t))}}};const M=e=>e.reduce(((e,t)=>("violated"===t.status?e.violated+=1:"jeopardized"===t.status?e.jeopardized+=1:"running"===t.status?e.running+=1:"successful"===t.status&&(e.successful+=1),e)),{running:0,successful:0,violated:0,jeopardized:0});t._parseDeploymentTriggers=M;const x=["jeopardy-result","violation-result","status"];t.getServiceDeployments=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.funcs,n=void 0===t?{}:t,c=n.readThunk,r=void 0===c?d.read:c,o=n.jsonrpc,i=void 0===o?s.default:o;return e=>(e(P()),e(r()).then((t=>{let n=t.th;return i("query",{th:n,selection:x,xpath_expr:"//service-progress-monitoring/trigger-status"}).then((t=>e(O(M((0,s.zipQueryResult)(x,t.results))))))})).catch((()=>e(I()))))};const V=e=>(0,i.toNumber)((0,o.flatten)((0,o.ensureArray)(e&&e.result.results)).shift()),G=e=>t=>t.reduce(((t,n,c)=>({...t,[e[c].path]:{count:V(n),name:e[c].name,servicePoint:e[c].path}})),{});t._resultToInstanceCount=G;const $=(e,t)=>e.map((e=>((e,t)=>({method:"query",params:{path:e,th:t,selection:[`count(${e})`],initial_offset:0,chunk_size:1,result_as:"string"}}))(e.path,t)));t._requestServiceCounts=$;const z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.funcs,i=void 0===r?{}:r,a=i.batch,l=void 0===a?s.jsonrpcBatch:a;return async n=>{let r={};const s=n.filter((e=>!c.isAccessDenied(e.schema)));if((0,o.isNonEmptyArray)(s)){const e=$(s,t),n=await l({requests:e});r=await G(s)(n)}await e(b(r))}};t._countServices=z,t.getServiceInstanceCount=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.funcs,n=void 0===t?{}:t,c=n.getServicePointsAndSchemasFunc,r=void 0===c?L:c,s=n.readThunk,o=void 0===s?d.read:s,i=n.serviceCounter,a=void 0===i?z:i;return async(e,t)=>{if((0,h.selectServiceInstanceCountIsLoading)(t()))return Promise.resolve();try{e(T());const t=(await e(o({mode:S.MODES.READ}))).th,n=await e(r());return await a(e,t)(n)}catch(t){return e(R(t))}}},t.runServiceActionThunk=e=>{let t=e.action,n=e.servicePath,c=e.funcs,r=(void 0===c?{}:c).runCustomActionThunk,s=void 0===r?m.runCustomActionThunk:r;const o=(e=>{let t=e.action,n=e.servicePath;return"re-deploy dry-run"===t?{actionPath:`${n}/${t}`,executePath:`${n}/re-deploy`}:{actionPath:`${n}/${t}`}})({action:t,servicePath:n});return s({action:t,actionPath:o.actionPath,executePath:o.executePath})}},86921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SERVICE_COLUMNS=t.SERVICE_MANAGER_USER_STORAGE_PATH=t.COLUMNS_ACTION=t.SERVICE_ACTIONS=void 0;const n=["check-sync","re-deploy","re-deploy dry-run"];t.SERVICE_ACTIONS=n;const c=n.map((e=>({key:e,title:e})));t.COLUMNS_ACTION=c,t.SERVICE_MANAGER_USER_STORAGE_PATH="SERVICE_MANAGER_USER_STORAGE_PATH",t.SERVICE_COLUMNS=[{key:"devices",title:"devices",canBeHidden:!0},{key:"check-sync",title:"check-sync",canBeHidden:!0},{key:"re-deploy",title:"re-deploy",canBeHidden:!0},{key:"re-deploy dry-run",title:"re-deploy dry-run",canBeHidden:!0},{key:"plan",title:"plan",canBeHidden:!0}]},23143:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._getParentPathObjects=t._EMPTY_OBJECT=t.selectServiceColumns=t.selectServiceSearch=t.selectServiceDeploymentsIsLoading=t.selectServiceDeploymentCount=t.selectServiceDeployments=t.selectServiceInstanceCountIsLoading=t.selectServiceCountTotal=t.selectServiceCountByType=t.selectServiceInstanceCount=t.selectServiceListIsLoading=t.selectServiceIsLoading=t.selectSelectedServiceCount=t.selectSelectedServiceRows=t.selectServiceCount=t.selectServiceRows=t.selectDynamicColumns=t.findKeyPath=t.isNotKeypathValueResult=t.selectZombieServiceRows=t.selectZombiesIsLoading=t.getDeviceItems=t.selectServiceIncludesPlan=t.buildYangActions=t.selectTotalNumberOfServices=t.selectServiceSortOrder=t.selectServiceSortColumn=t.selectServiceOffset=t.getExpandedColumnName=t.isExpanded=t.selectExpandedRow=t.selectExpandedRows=t.selectCurrentServiceNode=t.selectServiceSchemas=t.selectAllServiceNodes=t.selectServiceNodes=t.selectServicePoint=t.selectServicePointsKeypaths=t.selectServicePoints=t.servicePointsSelector=t.selectServicesMetaData=t.servicesSelector=void 0;var c=n(22222),r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var c={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var o=r?Object.getOwnPropertyDescriptor(e,s):null;o&&(o.get||o.set)?Object.defineProperty(c,s,o):c[s]=e[s]}return c.default=e,n&&n.set(e,c),c}(n(39562)),s=n(74198),o=n(94030),i=n(46560),a=n(59235),l=n(65050),u=n(5533),d=n(98883),S=n(17223),v=n(43801),p=n(86921),y=n(81951),h=n(40801);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,c=new Array(t);n<t;n++)c[n]=e[n];return c}const f=Object.freeze({});t._EMPTY_OBJECT=f;const E=e=>e.services||f;t.servicesSelector=E;const C=e=>E(e).services||f;t.selectServicesMetaData=C;const _=e=>E(e).servicePoints||f;t.servicePointsSelector=_,t.selectServicePoints=e=>E(e).servicePoints||void 0,t.selectServicePointsKeypaths=e=>Object.keys(_(e));const A=(e,t)=>(t||{}).path||"";t.selectServicePoint=A;const O=(0,c.createSelector)(_,l.selectNodes,A,((e,t,n)=>Object.values(e).reduce(((e,c)=>{let r=c.path;return((e,t,n)=>(e===t||!(0,o.isNonEmptyString)(t))&&n[e])(r,n,t)?{...e,[r]:t[r]}:e}),{})));t.selectServiceNodes=O;const P=(0,c.createSelector)(_,l.selectNodes,((e,t)=>Object.values(e).reduce(((e,n)=>{let c=n.path;return{...e,[c]:t[c]}}),{})));t.selectAllServiceNodes=P;const I=(0,c.createSelector)(_,(e=>e),((e,t)=>t),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=n.funcs,r=void 0===c?{}:c,s=r.selectSchema,o=void 0===s?S.selectSchema:s;return Object.values(e).reduce(((e,n)=>{let c=n.path;return{...e,[c]:o(t,c)}}),{})}));t.selectServiceSchemas=I;const T=(e,t)=>{const n=A(0,t);return O(e,t)[n]||f};t.selectCurrentServiceNode=T;const b=e=>E(e).expandedRows||f;t.selectExpandedRows=b,t.selectExpandedRow=(e,t)=>b(e)[t]||f;const R=e=>!!(e||{}).isExpanded;t.isExpanded=R;const k=e=>(e||{}).column;t.getExpandedColumnName=k,t.selectServiceOffset=(e,t)=>T(e,t).offset||1,t.selectServiceSortColumn=(e,t)=>T(e,t).sort,t.selectServiceSortOrder=(e,t)=>T(e,t).sortOrder,t.selectTotalNumberOfServices=(e,t)=>T(e,t).totalNumberOfResults||0;const N=(e,t)=>p.SERVICE_ACTIONS.reduce(((n,c)=>({...n,[c]:t[`${e}/${c}`]})),{});t.buildYangActions=N;const w={"re-deploy":a.getRedeployStatus,"check-sync":a.getCheckInSyncStatus,"re-deploy dry-run":a.getRedeployDryRunStatus},j=e=>w[e]||a.getCheckInSyncStatus,D=(0,c.createSelector)(O,I,((e,t)=>{const n=Object.keys(e);if(0===n.length)return!1;const c=t[n[0]];return!!(c&&c.children&&c.children.find((e=>"plan"===e.name)))}));t.selectServiceIncludesPlan=D;const L=e=>{if(!("rows"in e))return e;const t="/ncs:devices/device",n=e.rows.map((e=>({name:e[0],path:`${t}{${(0,d.quoteKey)(e[0])}}`})));return{...e,rows:[{name:"Devices",path:t,children:n}]}};t.getDeviceItems=L,t.selectZombiesIsLoading=e=>{const t=e.nodes["/ncs:zombies/service"];return!(!t||!t.isLoading)&&t.isLoading};const M=(0,c.createSelector)((e=>e.nodes["/ncs:zombies/service"]||f),b,A,((e,t,n)=>{const c=e&&e.rows?e.rows:[];if(!n)return[];const r=n.split(":")[0];return c.filter((e=>!!e["service-path"].startsWith(r))).map((e=>{const n=`/ncs:zombies/service{"${e["service-path"]}"}`,c=R(t[n]),r=k(t[n]);return{rowKey:n,data:{...e,expandable:{isExpanded:c,column:r||""}}}}))}));t.selectZombieServiceRows=M;const x=(e,t,n)=>!e&&!t[0][n[0]].keypath;t.isNotKeypathValueResult=x;const V=e=>{const t=Object.entries(e).find((e=>{return!!(t=e,n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var c,r,s=[],o=!0,i=!1;try{for(n=n.call(e);!(o=(c=n.next()).done)&&(s.push(c.value),!t||s.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(i)throw r}}return s}}(t,n)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[1].keypath;var t,n}));if(t)return t[1].keypath.slice(0,-(t[0].length+1))};t.findKeyPath=V;const G=(0,c.createSelector)(O,I,((e,t)=>{const n=Object.keys(e);if(n.length>0){const e=t[n[0]],c=r.getKeys(e);return r.isContainer(e)?[{key:"name",title:"name",canBeHidden:!0}]:c.map((e=>({key:e,title:e,canBeHidden:!0})))}return[]}));t.selectDynamicColumns=G;const $=e=>{try{const t=(0,h.pathToObjects)(e),n=t.filter((e=>"key"===e.type&&e.listEntry));return"name"===t[t.length-1].type?n:n.slice(0,-1)}catch{return[]}};t._getParentPathObjects=$;const z=(0,c.createSelector)(l.selectNodes,O,I,C,a.selectYangActions,b,u.selectDirtyPaths,((e,t,n,c,s,o,i)=>Object.keys(t).reduce(((l,d)=>{const S=t[d],p=Array.isArray(S.rows)?S.rows:[],y=n[d],h=r.getKeys(y),m=r.isContainer(y);return void 0===y||((e,t)=>e.reduce(((e,n)=>n.isLoading||t.reduce(((e,t)=>!(t in n)||e),!1)),!0))(p,h)||x(m,p,h)?l:[...l,...p.map((t=>{const n=m?V(t)||r.keypath(y):V(t),l=c[n]||f,d=N(n,s),S=k(o[n]),p=(e=>Object.keys(e).reduce(((t,n)=>({...t,[n]:{status:(0,a.getActionStatus)(e,n,j(n)).actionStatus,yangAction:{...e[n],actionStatus:{}}}})),{}))(d),g=(0,u.pathIsDirty)(n,i);S&&p[S]&&(p[S].isExpanded=R(o[n]));const E=e[`${n}/modified/devices`],C="devices"===S&&E?L(E):{},_=m?{name:r.qname(y)}:h.reduce(((e,n)=>({...e,[n]:t[n].value})),{}),A=Object.keys(_).map((e=>e)),O=$(n);return{rowKey:n,data:{...l,...p,..._,keys:A,parentListPaths:O,devices:t["count(modified/devices)"].value,planLocation:(t["plan-location"]||{}).value,expandable:{isExpanded:R(o[n]),column:S,yangAction:{...(d||{})[S],actionStatus:p[S]}},type:r.name(y),to:(0,v.getLinkWithPath)(n),isDirty:g,deviceItemsData:C}}}))]}),[])));t.selectServiceRows=z;const U=(0,c.createSelector)(z,(e=>e.length));t.selectServiceCount=U;const H=(0,c.createSelector)(z,(e=>e.filter((e=>e.data.isSelected))));t.selectSelectedServiceRows=H;const K=(0,c.createSelector)(H,(e=>e.length));t.selectSelectedServiceCount=K,t.selectServiceIsLoading=e=>!!E(e).isLoading,t.selectServiceListIsLoading=(e,t)=>!(!e.nodes[t]||!e.nodes[t].isLoading);const B=e=>E(e).instanceCount||{};t.selectServiceInstanceCount=B,t.selectServiceCountByType=e=>{const t=B(e);return Object.keys(t).reduce(((e,n)=>{const c=t[n];return c.count>0&&e.push({name:c.name,value:c.count,servicePoint:c.servicePoint}),e}),[]).sort(((e,t)=>e.name.localeCompare(t.name)))},t.selectServiceCountTotal=e=>{const t=B(e);return Object.keys(t).reduce(((e,n)=>e+t[n].count),0)},t.selectServiceInstanceCountIsLoading=e=>!0===E(e).instanceCountIsLoading;const q=Object.freeze({running:0,successful:0,jeopardized:0,violated:0}),W=e=>E(e).deployments||q;t.selectServiceDeployments=W,t.selectServiceDeploymentCount=e=>{const t=W(e);return(0,s.ensureNumber)(t.jeopardized)+(0,s.ensureNumber)(t.successful)+(0,s.ensureNumber)(t.running)+(0,s.ensureNumber)(t.violated)},t.selectServiceDeploymentsIsLoading=e=>!!E(e).deploymentsIsLoading,t.selectServiceSearch=e=>(0,i.pathOr)("",["services","search","value"],e);const Y={path:p.SERVICE_MANAGER_USER_STORAGE_PATH},F=(0,y.createColumnsVisibilitySelector)();t.selectServiceColumns=e=>F(e,Y)}}]);